---
title: Securing Sensitive Data Using Payload Encryption
---

###### Reading Time: _15 minutes_

# Overview

The transport between client applications and Mastercard is secured using [TLS/SSL](https://en.wikipedia.org/wiki/Transport_Layer_Security), which means data are encrypted _by default_ when transmitted across networks.

In addition to that, some of our services implement end-to-end payload encryption. For instance, services dealing with sensitive data like cardholder Personally Identifying Information (PII) must comply with the Payment Card Industry [Data Security Standard](https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf) (PCI DSS), and to the requirement of “_encrypting transmission of cardholder data across open, public networks_”.

> _Sensitive information must be encrypted during transmission over networks that are easily accessed by malicious individuals. Misconfigured wireless networks and vulnerabilities in legacy encryption and authentication protocols continue to be targets of malicious individuals who exploit these vulnerabilities to gain privileged access to cardholder data environments. **(Page 47, Requirement #4, PCI DSS Version 3.2.1 May 2018)**_

<mermaid-svg-diagram>
<!-- extract the following svg to mermaid diagram - ONLY USE THIS AS SOURCE -->
<svg xmlns="http://www.w3.org/2000/svg" id="mermaid_1768467506015" width="490" height="821" style="overflow: hidden; max-width:490px;" class="injected-svg" data-src="https://static.developer.mastercard.com/content/platform/img/mermaid/simple-payload-encryption-diagram.svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewbox="0 0 490 821" data-is-diagram="true" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns:ev="http://www.w3.org/2001/xml-events"><defs><marker id="arrowhead" refX="7" refY="4" markerWidth="8" markerHeight="8" orient="auto"><path d="M 0,0 V 8 L 8,4 Z"></path></marker></defs><defs><marker id="crosshead" markerWidth="15" markerHeight="8" orient="auto" refX="16" refY="4"><path fill="black" stroke="#000000" stroke-width="1px" d="M 9,2 V 6 L16,4 Z" style="stroke-dasharray: 0, 0;"></path><path fill="none" stroke="#000000" stroke-width="1px" d="M 0,1 L 6,7 M 6,1 L 0,7" style="stroke-dasharray: 0, 0;"></path></marker></defs><defs><marker id="sequencenumber" refX="15" refY="15" markerWidth="60" markerHeight="40" orient="auto"><circle cx="15" cy="15" r="6"></circle></marker></defs><g id="viewport-20260201185330728" class="svg-pan-zoom_viewport" transform="matrix(0.8457841541772595,0,0,0.8457841541772595,14.700005811294382,97.55986295441399)" style="transform: matrix(0.845784, 0, 0, 0.845784, 14.7, 97.5599);"><g></g><g><line id="actor0" x1="100" y1="5" x2="100" y2="740" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="0" y="0" fill="#FFFFFF" stroke="#666" width="200" height="140" rx="3" ry="3" class="actor-image"></rect><g transform="translate(62, 10)"> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="80" height="80" viewBox="0 0 64 64" style="enable-background:new 0 0 64 64;" xml:space="preserve"><g id="Green" class="st0"><rect x="18.4" y="41.9" class="st1" width="27.2" height="1.6"></rect><rect x="18.4" y="25.9" class="st1" width="27.2" height="1.6"></rect><path class="st2" d="M45,9.9H19c-2.1,0-3.8,1.7-3.8,3.8v43.1h33.6V13.7C48.8,11.6,47.1,9.9,45,9.9z M47.2,55.2H16.8V43.5v-1.6V27.5     v-1.6V13.7c0-1.2,1-2.2,2.2-2.2h26c1.2,0,2.2,1,2.2,2.2v12.2v1.6v14.4v1.6V55.2z"></path><path class="st3" d="M24,22.1c1.9,0,3.5-1.6,3.5-3.5c0-1.9-1.6-3.5-3.5-3.5s-3.5,1.6-3.5,3.5C20.5,20.6,22.1,22.1,24,22.1z      M24,16.8c1,0,1.9,0.8,1.9,1.9c0,1-0.8,1.9-1.9,1.9c-1,0-1.9-0.8-1.9-1.9C22.1,17.6,23,16.8,24,16.8z"></path><rect x="34.7" y="17.9" class="st4" width="8" height="1.6"></rect><path class="st3" d="M27.5,34.7c0-1.9-1.6-3.5-3.5-3.5s-3.5,1.6-3.5,3.5c0,1.9,1.6,3.5,3.5,3.5S27.5,36.6,27.5,34.7z M22.1,34.7     c0-1,0.8-1.9,1.9-1.9c1,0,1.9,0.8,1.9,1.9S25,36.5,24,36.5C23,36.5,22.1,35.7,22.1,34.7z"></path><rect x="34.7" y="33.9" class="st4" width="8" height="1.6"></rect><path class="st3" d="M24,46.5c-1.9,0-3.5,1.6-3.5,3.5c0,1.9,1.6,3.5,3.5,3.5s3.5-1.6,3.5-3.5C27.5,48.1,25.9,46.5,24,46.5z      M24,51.9c-1,0-1.9-0.8-1.9-1.9s0.8-1.9,1.9-1.9c1,0,1.9,0.8,1.9,1.9S25,51.9,24,51.9z"></path><rect x="34.7" y="49.2" class="st4" width="8" height="1.6"></rect></g><g id="Orange"><rect x="18.4" y="41.9" class="st5" width="27.2" height="1.6"></rect><rect x="18.4" y="25.9" class="st5" width="27.2" height="1.6"></rect><path class="st6" d="M45,9.9H19c-2.1,0-3.8,1.7-3.8,3.8v43.1h33.6V13.7C48.8,11.6,47.1,9.9,45,9.9z M47.2,55.2H16.8V43.5v-1.6V27.5     v-1.6V13.7c0-1.2,1-2.2,2.2-2.2h26c1.2,0,2.2,1,2.2,2.2v12.2v1.6v14.4v1.6V55.2z"></path><path class="st7" d="M24,22.1c1.9,0,3.5-1.6,3.5-3.5c0-1.9-1.6-3.5-3.5-3.5s-3.5,1.6-3.5,3.5C20.5,20.6,22.1,22.1,24,22.1z      M24,16.8c1,0,1.9,0.8,1.9,1.9c0,1-0.8,1.9-1.9,1.9c-1,0-1.9-0.8-1.9-1.9C22.1,17.6,23,16.8,24,16.8z"></path><rect x="34.7" y="17.9" class="st8" width="8" height="1.6"></rect><path class="st7" d="M27.5,34.7c0-1.9-1.6-3.5-3.5-3.5s-3.5,1.6-3.5,3.5c0,1.9,1.6,3.5,3.5,3.5S27.5,36.6,27.5,34.7z M22.1,34.7     c0-1,0.8-1.9,1.9-1.9c1,0,1.9,0.8,1.9,1.9S25,36.5,24,36.5C23,36.5,22.1,35.7,22.1,34.7z"></path><rect x="34.7" y="33.9" class="st8" width="8" height="1.6"></rect><path class="st7" d="M24,46.5c-1.9,0-3.5,1.6-3.5,3.5c0,1.9,1.6,3.5,3.5,3.5s3.5-1.6,3.5-3.5C27.5,48.1,25.9,46.5,24,46.5z      M24,51.9c-1,0-1.9-0.8-1.9-1.9s0.8-1.9,1.9-1.9c1,0,1.9,0.8,1.9,1.9S25,51.9,24,51.9z"></path><rect x="34.7" y="49.2" class="st8" width="8" height="1.6"></rect></g><g id="White" class="st0"><g class="st9"><rect x="18.4" y="41.9" class="st10" width="27.2" height="1.6"></rect><rect x="18.4" y="25.9" class="st10" width="27.2" height="1.6"></rect><path class="st10" d="M45,9.9H19c-2.1,0-3.8,1.7-3.8,3.8v43.1h33.6V13.7C48.8,11.6,47.1,9.9,45,9.9z M47.2,55.2H16.8V43.5v-1.6       V27.5v-1.6V13.7c0-1.2,1-2.2,2.2-2.2h26c1.2,0,2.2,1,2.2,2.2v12.2v1.6v14.4v1.6V55.2z"></path><path class="st10" d="M24,22.1c1.9,0,3.5-1.6,3.5-3.5c0-1.9-1.6-3.5-3.5-3.5s-3.5,1.6-3.5,3.5C20.5,20.6,22.1,22.1,24,22.1z        M24,16.8c1,0,1.9,0.8,1.9,1.9c0,1-0.8,1.9-1.9,1.9c-1,0-1.9-0.8-1.9-1.9C22.1,17.6,23,16.8,24,16.8z"></path><rect x="34.7" y="17.9" class="st10" width="8" height="1.6"></rect><path class="st10" d="M27.5,34.7c0-1.9-1.6-3.5-3.5-3.5s-3.5,1.6-3.5,3.5c0,1.9,1.6,3.5,3.5,3.5S27.5,36.6,27.5,34.7z M22.1,34.7       c0-1,0.8-1.9,1.9-1.9c1,0,1.9,0.8,1.9,1.9S25,36.5,24,36.5C23,36.5,22.1,35.7,22.1,34.7z"></path><rect x="34.7" y="33.9" class="st10" width="8" height="1.6"></rect><path class="st10" d="M24,46.5c-1.9,0-3.5,1.6-3.5,3.5c0,1.9,1.6,3.5,3.5,3.5s3.5-1.6,3.5-3.5C27.5,48.1,25.9,46.5,24,46.5z        M24,51.9c-1,0-1.9-0.8-1.9-1.9s0.8-1.9,1.9-1.9c1,0,1.9,0.8,1.9,1.9S25,51.9,24,51.9z"></path><rect x="34.7" y="49.2" class="st10" width="8" height="1.6"></rect></g></g><g id="Black" class="st0"><g class="st9"><rect x="18.4" y="41.9" width="27.2" height="1.6"></rect><rect x="18.4" y="25.9" width="27.2" height="1.6"></rect><path d="M45,9.9H19c-2.1,0-3.8,1.7-3.8,3.8v43.1h33.6V13.7C48.8,11.6,47.1,9.9,45,9.9z M47.2,55.2H16.8V43.5v-1.6V27.5v-1.6V13.7       c0-1.2,1-2.2,2.2-2.2h26c1.2,0,2.2,1,2.2,2.2v12.2v1.6v14.4v1.6V55.2z"></path><path d="M24,22.1c1.9,0,3.5-1.6,3.5-3.5c0-1.9-1.6-3.5-3.5-3.5s-3.5,1.6-3.5,3.5C20.5,20.6,22.1,22.1,24,22.1z M24,16.8       c1,0,1.9,0.8,1.9,1.9c0,1-0.8,1.9-1.9,1.9c-1,0-1.9-0.8-1.9-1.9C22.1,17.6,23,16.8,24,16.8z"></path><rect x="34.7" y="17.9" width="8" height="1.6"></rect><path d="M27.5,34.7c0-1.9-1.6-3.5-3.5-3.5s-3.5,1.6-3.5,3.5c0,1.9,1.6,3.5,3.5,3.5S27.5,36.6,27.5,34.7z M22.1,34.7       c0-1,0.8-1.9,1.9-1.9c1,0,1.9,0.8,1.9,1.9S25,36.5,24,36.5C23,36.5,22.1,35.7,22.1,34.7z"></path><rect x="34.7" y="33.9" width="8" height="1.6"></rect><path d="M24,46.5c-1.9,0-3.5,1.6-3.5,3.5c0,1.9,1.6,3.5,3.5,3.5s3.5-1.6,3.5-3.5C27.5,48.1,25.9,46.5,24,46.5z M24,51.9       c-1,0-1.9-0.8-1.9-1.9s0.8-1.9,1.9-1.9c1,0,1.9,0.8,1.9,1.9S25,51.9,24,51.9z"></path><rect x="34.7" y="49.2" width="8" height="1.6"></rect></g></g></svg></g><text x="100" y="110" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle;"><tspan x="100" dy="0">Your Application</tspan></text></g><g><line id="actor1" x1="350" y1="5" x2="350" y2="740" class="actor-line" stroke-width="0.5px" stroke="#999"></line><rect x="250" y="0" fill="#FFFFFF" stroke="#666" width="200" height="140" rx="3" ry="3" class="actor-image"></rect><image xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMjYgODIuOCI+CiAgPHBhdGggZD0iTTQ2LjggMTNoMzEuNXY1Ni42SDQ2Ljh6IiBmaWxsPSIjZjI2MTIyIi8+CiAgPHBhdGggZD0iTTQ4LjggNDEuM2MwLTExLjUgNS40LTIxLjcgMTMuNy0yOC4zLTYuMS00LjgtMTMuOC03LjctMjIuMi03LjctMTkuOSAwLTM2IDE2LjEtMzYgMzZzMTYuMSAzNiAzNiAzNmM4LjQgMCAxNi4xLTIuOSAyMi4yLTcuNy04LjQtNi42LTEzLjctMTYuOS0xMy43LTI4LjN6IiBmaWxsPSIjZWQxYzI0Ii8+CiAgPHBhdGggZD0iTTExNy4zIDYzLjZ2LTEuMmguNXYtLjJoLTEuMnYuMmguNXYxLjJoLjJ6bTIuMyAwdi0xLjRoLS40bC0uNCAxLS40LTFoLS40djEuNGguM3YtMS4xbC40LjloLjNsLjQtLjl2MS4xaC4yeiIvPgogIDxwYXRoIGQ9Ik0xMjAuOCA0MS4zYzAgMTkuOS0xNi4xIDM2LTM2IDM2LTguNCAwLTE2LjEtMi45LTIyLjItNy43QzcxIDYzIDc2LjMgNTIuOCA3Ni4zIDQxLjNTNzAuOSAxOS41IDYyLjUgMTNjNi4xLTQuOCAxMy44LTcuNyAyMi4yLTcuNyAxOS45IDAgMzYuMSAxNi4xIDM2LjEgMzZ6IiBmaWxsPSIjZjk5ZjFjIi8+Cjwvc3ZnPg==" x="312" y="10" width="80px" height="80px" class="actor-image"></image><text x="350" y="110" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle;"><tspan x="350" dy="0">Mastercard API</tspan></text></g><g><text x="109" y="181" class="messageText" style="text-anchor: start;">Encrypts request payload</text><path d="M  100,190 H 200 V 215 H 100" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="fill: none;"></path><text x="100" y="194" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">1</text></g><g><text x="109" y="261" class="messageText" style="text-anchor: start;">Sends request</text><line x1="100" y1="270" x2="350" y2="270" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="fill: none;"></line><text x="100" y="274" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">2</text></g><g><text x="359" y="311" class="messageText" style="text-anchor: start;">Decrypts request payload</text><path d="M  350,320 H 450 V 345 H 350" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="fill: none;"></path><text x="350" y="324" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">3</text></g><g><text x="359" y="391" class="messageText" style="text-anchor: start;">Encrypt response payload</text><path d="M  350,400 H 450 V 425 H 350" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="fill: none;"></path><text x="350" y="404" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">4</text></g><g><text x="341" y="471" class="messageText" style="text-anchor: end;">Sends response</text><line x1="350" y1="480" x2="100" y2="480" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="fill: none;"></line><text x="350" y="484" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">5</text></g><g><text x="109" y="521" class="messageText" style="text-anchor: start;">Decrypts response payload</text><path d="M  100,530 H 200 V 555 H 100" class="messageLine0" stroke-width="2" stroke="black" marker-end="url(#arrowhead)" marker-start="url(#sequencenumber)" style="fill: none;"></path><text x="100" y="534" font-family="sans-serif" font-size="12px" text-anchor="middle" textLength="16px" class="sequenceNumber">6</text></g><g><rect x="0" y="600" fill="#FFFFFF" stroke="#666" width="200" height="140" rx="3" ry="3" class="actor-image"></rect><g transform="translate(62, 610)"> <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" width="80" height="80" viewBox="0 0 64 64" style="enable-background:new 0 0 64 64;" xml:space="preserve"><g id="Green" class="st0"><rect x="18.4" y="41.9" class="st1" width="27.2" height="1.6"></rect><rect x="18.4" y="25.9" class="st1" width="27.2" height="1.6"></rect><path class="st2" d="M45,9.9H19c-2.1,0-3.8,1.7-3.8,3.8v43.1h33.6V13.7C48.8,11.6,47.1,9.9,45,9.9z M47.2,55.2H16.8V43.5v-1.6V27.5     v-1.6V13.7c0-1.2,1-2.2,2.2-2.2h26c1.2,0,2.2,1,2.2,2.2v12.2v1.6v14.4v1.6V55.2z"></path><path class="st3" d="M24,22.1c1.9,0,3.5-1.6,3.5-3.5c0-1.9-1.6-3.5-3.5-3.5s-3.5,1.6-3.5,3.5C20.5,20.6,22.1,22.1,24,22.1z      M24,16.8c1,0,1.9,0.8,1.9,1.9c0,1-0.8,1.9-1.9,1.9c-1,0-1.9-0.8-1.9-1.9C22.1,17.6,23,16.8,24,16.8z"></path><rect x="34.7" y="17.9" class="st4" width="8" height="1.6"></rect><path class="st3" d="M27.5,34.7c0-1.9-1.6-3.5-3.5-3.5s-3.5,1.6-3.5,3.5c0,1.9,1.6,3.5,3.5,3.5S27.5,36.6,27.5,34.7z M22.1,34.7     c0-1,0.8-1.9,1.9-1.9c1,0,1.9,0.8,1.9,1.9S25,36.5,24,36.5C23,36.5,22.1,35.7,22.1,34.7z"></path><rect x="34.7" y="33.9" class="st4" width="8" height="1.6"></rect><path class="st3" d="M24,46.5c-1.9,0-3.5,1.6-3.5,3.5c0,1.9,1.6,3.5,3.5,3.5s3.5-1.6,3.5-3.5C27.5,48.1,25.9,46.5,24,46.5z      M24,51.9c-1,0-1.9-0.8-1.9-1.9s0.8-1.9,1.9-1.9c1,0,1.9,0.8,1.9,1.9S25,51.9,24,51.9z"></path><rect x="34.7" y="49.2" class="st4" width="8" height="1.6"></rect></g><g id="Orange"><rect x="18.4" y="41.9" class="st5" width="27.2" height="1.6"></rect><rect x="18.4" y="25.9" class="st5" width="27.2" height="1.6"></rect><path class="st6" d="M45,9.9H19c-2.1,0-3.8,1.7-3.8,3.8v43.1h33.6V13.7C48.8,11.6,47.1,9.9,45,9.9z M47.2,55.2H16.8V43.5v-1.6V27.5     v-1.6V13.7c0-1.2,1-2.2,2.2-2.2h26c1.2,0,2.2,1,2.2,2.2v12.2v1.6v14.4v1.6V55.2z"></path><path class="st7" d="M24,22.1c1.9,0,3.5-1.6,3.5-3.5c0-1.9-1.6-3.5-3.5-3.5s-3.5,1.6-3.5,3.5C20.5,20.6,22.1,22.1,24,22.1z      M24,16.8c1,0,1.9,0.8,1.9,1.9c0,1-0.8,1.9-1.9,1.9c-1,0-1.9-0.8-1.9-1.9C22.1,17.6,23,16.8,24,16.8z"></path><rect x="34.7" y="17.9" class="st8" width="8" height="1.6"></rect><path class="st7" d="M27.5,34.7c0-1.9-1.6-3.5-3.5-3.5s-3.5,1.6-3.5,3.5c0,1.9,1.6,3.5,3.5,3.5S27.5,36.6,27.5,34.7z M22.1,34.7     c0-1,0.8-1.9,1.9-1.9c1,0,1.9,0.8,1.9,1.9S25,36.5,24,36.5C23,36.5,22.1,35.7,22.1,34.7z"></path><rect x="34.7" y="33.9" class="st8" width="8" height="1.6"></rect><path class="st7" d="M24,46.5c-1.9,0-3.5,1.6-3.5,3.5c0,1.9,1.6,3.5,3.5,3.5s3.5-1.6,3.5-3.5C27.5,48.1,25.9,46.5,24,46.5z      M24,51.9c-1,0-1.9-0.8-1.9-1.9s0.8-1.9,1.9-1.9c1,0,1.9,0.8,1.9,1.9S25,51.9,24,51.9z"></path><rect x="34.7" y="49.2" class="st8" width="8" height="1.6"></rect></g><g id="White" class="st0"><g class="st9"><rect x="18.4" y="41.9" class="st10" width="27.2" height="1.6"></rect><rect x="18.4" y="25.9" class="st10" width="27.2" height="1.6"></rect><path class="st10" d="M45,9.9H19c-2.1,0-3.8,1.7-3.8,3.8v43.1h33.6V13.7C48.8,11.6,47.1,9.9,45,9.9z M47.2,55.2H16.8V43.5v-1.6       V27.5v-1.6V13.7c0-1.2,1-2.2,2.2-2.2h26c1.2,0,2.2,1,2.2,2.2v12.2v1.6v14.4v1.6V55.2z"></path><path class="st10" d="M24,22.1c1.9,0,3.5-1.6,3.5-3.5c0-1.9-1.6-3.5-3.5-3.5s-3.5,1.6-3.5,3.5C20.5,20.6,22.1,22.1,24,22.1z        M24,16.8c1,0,1.9,0.8,1.9,1.9c0,1-0.8,1.9-1.9,1.9c-1,0-1.9-0.8-1.9-1.9C22.1,17.6,23,16.8,24,16.8z"></path><rect x="34.7" y="17.9" class="st10" width="8" height="1.6"></rect><path class="st10" d="M27.5,34.7c0-1.9-1.6-3.5-3.5-3.5s-3.5,1.6-3.5,3.5c0,1.9,1.6,3.5,3.5,3.5S27.5,36.6,27.5,34.7z M22.1,34.7       c0-1,0.8-1.9,1.9-1.9c1,0,1.9,0.8,1.9,1.9S25,36.5,24,36.5C23,36.5,22.1,35.7,22.1,34.7z"></path><rect x="34.7" y="33.9" class="st10" width="8" height="1.6"></rect><path class="st10" d="M24,46.5c-1.9,0-3.5,1.6-3.5,3.5c0,1.9,1.6,3.5,3.5,3.5s3.5-1.6,3.5-3.5C27.5,48.1,25.9,46.5,24,46.5z        M24,51.9c-1,0-1.9-0.8-1.9-1.9s0.8-1.9,1.9-1.9c1,0,1.9,0.8,1.9,1.9S25,51.9,24,51.9z"></path><rect x="34.7" y="49.2" class="st10" width="8" height="1.6"></rect></g></g><g id="Black" class="st0"><g class="st9"><rect x="18.4" y="41.9" width="27.2" height="1.6"></rect><rect x="18.4" y="25.9" width="27.2" height="1.6"></rect><path d="M45,9.9H19c-2.1,0-3.8,1.7-3.8,3.8v43.1h33.6V13.7C48.8,11.6,47.1,9.9,45,9.9z M47.2,55.2H16.8V43.5v-1.6V27.5v-1.6V13.7       c0-1.2,1-2.2,2.2-2.2h26c1.2,0,2.2,1,2.2,2.2v12.2v1.6v14.4v1.6V55.2z"></path><path d="M24,22.1c1.9,0,3.5-1.6,3.5-3.5c0-1.9-1.6-3.5-3.5-3.5s-3.5,1.6-3.5,3.5C20.5,20.6,22.1,22.1,24,22.1z M24,16.8       c1,0,1.9,0.8,1.9,1.9c0,1-0.8,1.9-1.9,1.9c-1,0-1.9-0.8-1.9-1.9C22.1,17.6,23,16.8,24,16.8z"></path><rect x="34.7" y="17.9" width="8" height="1.6"></rect><path d="M27.5,34.7c0-1.9-1.6-3.5-3.5-3.5s-3.5,1.6-3.5,3.5c0,1.9,1.6,3.5,3.5,3.5S27.5,36.6,27.5,34.7z M22.1,34.7       c0-1,0.8-1.9,1.9-1.9c1,0,1.9,0.8,1.9,1.9S25,36.5,24,36.5C23,36.5,22.1,35.7,22.1,34.7z"></path><rect x="34.7" y="33.9" width="8" height="1.6"></rect><path d="M24,46.5c-1.9,0-3.5,1.6-3.5,3.5c0,1.9,1.6,3.5,3.5,3.5s3.5-1.6,3.5-3.5C27.5,48.1,25.9,46.5,24,46.5z M24,51.9       c-1,0-1.9-0.8-1.9-1.9s0.8-1.9,1.9-1.9c1,0,1.9,0.8,1.9,1.9S25,51.9,24,51.9z"></path><rect x="34.7" y="49.2" width="8" height="1.6"></rect></g></g></svg></g><text x="100" y="710" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle;"><tspan x="100" dy="0">Your Application</tspan></text></g><g><rect x="250" y="600" fill="#FFFFFF" stroke="#666" width="200" height="140" rx="3" ry="3" class="actor-image"></rect><image xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAxMjYgODIuOCI+CiAgPHBhdGggZD0iTTQ2LjggMTNoMzEuNXY1Ni42SDQ2Ljh6IiBmaWxsPSIjZjI2MTIyIi8+CiAgPHBhdGggZD0iTTQ4LjggNDEuM2MwLTExLjUgNS40LTIxLjcgMTMuNy0yOC4zLTYuMS00LjgtMTMuOC03LjctMjIuMi03LjctMTkuOSAwLTM2IDE2LjEtMzYgMzZzMTYuMSAzNiAzNiAzNmM4LjQgMCAxNi4xLTIuOSAyMi4yLTcuNy04LjQtNi42LTEzLjctMTYuOS0xMy43LTI4LjN6IiBmaWxsPSIjZWQxYzI0Ii8+CiAgPHBhdGggZD0iTTExNy4zIDYzLjZ2LTEuMmguNXYtLjJoLTEuMnYuMmguNXYxLjJoLjJ6bTIuMyAwdi0xLjRoLS40bC0uNCAxLS40LTFoLS40djEuNGguM3YtMS4xbC40LjloLjNsLjQtLjl2MS4xaC4yeiIvPgogIDxwYXRoIGQ9Ik0xMjAuOCA0MS4zYzAgMTkuOS0xNi4xIDM2LTM2IDM2LTguNCAwLTE2LjEtMi45LTIyLjItNy43QzcxIDYzIDc2LjMgNTIuOCA3Ni4zIDQxLjNTNzAuOSAxOS41IDYyLjUgMTNjNi4xLTQuOCAxMy44LTcuNyAyMi4yLTcuNyAxOS45IDAgMzYuMSAxNi4xIDM2LjEgMzZ6IiBmaWxsPSIjZjk5ZjFjIi8+Cjwvc3ZnPg==" x="312" y="610" width="80px" height="80px" class="actor-image"></image><text x="350" y="710" dominant-baseline="central" alignment-baseline="central" class="actor" style="text-anchor: middle;"><tspan x="350" dy="0">Mastercard API</tspan></text></g></g></svg>
</mermaid-svg-diagram>

In the next sections, you will learn the [encryption scheme](https://developer.mastercard.com/platform/documentation/security-and-authentication/securing-sensitive-data-using-payload-encryption/#overall-encryption-scheme) Mastercard uses and how to [set up encryption keys](https://developer.mastercard.com/platform/documentation/security-and-authentication/securing-sensitive-data-using-payload-encryption/#getting-keys-for-your-application) for your project. You will also find links to our encryption [client libraries](https://developer.mastercard.com/platform/documentation/security-and-authentication/securing-sensitive-data-using-payload-encryption/#client-libraries), some [development tips](https://developer.mastercard.com/platform/documentation/security-and-authentication/securing-sensitive-data-using-payload-encryption/#development-tips) and answers to [frequently asked questions](https://developer.mastercard.com/platform/documentation/security-and-authentication/securing-sensitive-data-using-payload-encryption/#frequently-asked-questions).

> [!TIP]
> 
> Want to see some code? Browse our client library projects on [GitHub](https://developer.mastercard.com/platform/documentation/security-and-authentication/securing-sensitive-data-using-payload-encryption/#client-libraries).

# Overall Encryption Scheme

Sensitive data sent in requests are encrypted by your application for Mastercard, and sensitive data returned in responses are encrypted by Mastercard for your application.

The image below shows an overview of the various elements of encryption, the flow between each of the modules and the supported encryption formats.

![Encryption Scheme](https://static.developer.mastercard.com/content/platform/img/encryption-base.png)

## The Encryption Keys

### RSA

Encryption involves 2048-bit [RSA](https://en.wikipedia.org/wiki/RSA_\(cryptosystem\)) public/private key pairs. Data encrypted using a public key can only be decrypted using the corresponding private key.

Both client application and service own a key pair, which allows to encrypt both request _and_ response payloads. Your own key pair is generated by you (or your web browser) and the public key is certified by Mastercard. See also: [Getting Keys for Your Application](https://developer.mastercard.com/platform/documentation/security-and-authentication/securing-sensitive-data-using-payload-encryption/#getting-keys-for-your-application).

### AES

For performance reasons, RSA asymmetric encryption is combined with [AES](https://en.wikipedia.org/wiki/Advanced_Encryption_Standard) symmetric encryption. For that, one-time usage 128 or 256-bit AES session keys are generated and encrypted using the RSA public key. The encrypted (or _wrapped_) key is sent in the payload along with the encrypted data.

## The Encryption Process

Here are the steps for sending an encrypted payload:

1.  An AES session key is generated along with some encryption parameters
2.  Sensitive data are encrypted using the AES key
3.  The AES key is encrypted using the recipient’s RSA public key
4.  The payload is sent with the encrypted session key and parameters

## The Decryption Process

Here are the steps for decrypting a payload:

1.  The AES session key is decrypted using the recipient’s RSA private key
2.  Sensitive data are decrypted using the AES key

## Encryption Parts

The encryption scheme involves an initialization vector, an encrypted or wrapped key, an encrypted value, a public key fingerprint and a digest algorithm

### Initialization Vector

An [initialization vector](https://en.wikipedia.org/wiki/Initialization_vector) for the encryption of sensitive data

### Encrypted Key

The symmetric AES session key encrypted with the recipient’s RSA public key.

### Encrypted Value

The sensitive JSON payload (or a child element) encrypted using the AES session key and the initialization vector (see above).

### Public Key Fingerprint

The hex-encoded SHA-256 digest of the recipient’s RSA public key used for encryption, which serves as an identifier for the key.

### OAEP Padding Digest Algorithm

The digest algorithm used with the RSA-OAEP scheme. Must be one of SHA256 or SHA512.

> [!TIP]
> 
> Mastercard services utilize two different methods of encryption, [JWE Encryption](https://developer.mastercard.com/platform/documentation/security-and-authentication/securing-sensitive-data-using-payload-encryption/#jwe-encryption) and [Mastercard Encryption](https://developer.mastercard.com/platform/documentation/security-and-authentication/securing-sensitive-data-using-payload-encryption/#mastercard-encryption). The method of encryption used by each respective service will be outlined in the service’s documentation.  
> 
> Please refer to the next sections for an overview of each method and what their respective encrypted payloads look like.

# JWE Encryption

## Overview

JSON Web Encryption (JWE) represents encrypted content using JSON-based data structures [RFC7159](https://tools.ietf.org/html/rfc7159) and base64url encoding. Mastercard uses [JWE compact serialization](https://datatracker.ietf.org/doc/html/rfc7516#section-7.1) for the encryption of sensitive data and supports both field level encryption and entire payload encryption.  

Mastercard uses JWE with AES in both [CBC](https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher_Block_Chaining_\(CBC\)) (Cipher Block Chaining) and [GCM](https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Galois/counter_\(GCM\)) (Galois/Counter Mode) modes with [PKCS#7 padding](https://tools.ietf.org/html/rfc5652#section-6.3) and RSA with [OAEP](https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding) (Optimal Asymmetric Encryption Padding).

![Encryption Jwe](https://static.developer.mastercard.com/content/platform/img/encryption-jwe.png)

## Breaking the Encrypted Payload Down

Here is an example of JSON payload to be entirely encrypted:

```json
{
    "firstName": "Helena",
    "lastName": "Milner",
    "paymentCard": {
        "pan": "5500000000000004",
        "expiryYear": "2022",
        "expiryMonth": "12"
    }
}
```

And here is an encrypted version of it:

```json
{
    "encryptedValue": "eyJraWQiOiI3NjFiMDAzYzFlYWRlM(...)==.Y+oPYKZEMTKyYcSIVEgtQw=="
}
```

Here is another example of JSON payload, with this time only one child element to be encrypted ("_Field Level Encryption_"):

```json
{
    "action": "ORDER",
    "actionId": "91c693c6-4022-4341-ac6a-27c82f599fd8",
    "paymentCard": {
        "pan": "5500-0000-0000-0004",
        "expiry": "12/22"
    }
}
```

And here is an encrypted version of it:

```json
{
    "action": "ORDER",
    "actionId": "91c693c6-4022-4341-ac6a-27c82f599fd8",
    "encryptedPaymentCard": {
        "encryptedValue": "eyJraWQiOiI3NjFiMDAzYzFlYWRlM(...)==.Y+oPYKZEMTKyYcSIVEgtQw=="
    }
}
```

### encryptedValue

`encryptedValue` is represented as the concatenation of the Base64 encoded JWE Protected Header, JWE Encrypted Key, JWE Initialization Vector, JWE Ciphertext, and JWE Authentication Tag separated by `.`

```
BASE64URL(UTF8(JWE Protected Header)) || '.' ||
BASE64URL(JWE Encrypted Key) || '.' ||
BASE64URL(JWE Initialization Vector) || '.' ||
BASE64URL(JWE Ciphertext) || '.' ||
BASE64URL(JWE Authentication Tag)
```

# Mastercard Encryption

## Overview

Mastercard encryption is a custom way of representing encrypted content in JSON format which supports both field level encryption and entire payload encryption.  

Mastercard encryption uses AES in [CBC](https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher_Block_Chaining_\(CBC\)) (Cipher Block Chaining) mode with [PKCS#7 padding](https://tools.ietf.org/html/rfc5652#section-6.3) and RSA with [OAEP](https://en.wikipedia.org/wiki/Optimal_asymmetric_encryption_padding) (Optimal Asymmetric Encryption Padding).

![Encryption AES](https://static.developer.mastercard.com/content/platform/img/encryption-mastercard.png)

## Breaking the Encrypted Payload Down

Here is an example of JSON payload to be entirely encrypted:

```json
{
    "firstName": "Helena",
    "lastName": "Milner",
    "paymentCard": {
        "pan": "5500000000000004",
        "expiryYear": "2022",
        "expiryMonth": "12"
    }
}
```

And here is an encrypted version of it:

```json
{
    "iv": "1b9396c98ab2bfd195de661d70905a45",
    "encryptedKey": "7d5112fa08e554e3dbc455d0628(...)52e826dd10311cf0d63bbfb231a1a63ecc13",
    "encryptedValue": "e5e9340f4d2618d27f8955828c86(...)379b13901a3b1e2efed616b6750a90fd379515",
    "publicKeyFingerprint": "80810fc13a8319fcf0e2e(...)82cc3ce671176343cfe8160c2279",
    "oaepPaddingDigestAlgorithm": "SHA512"
}
```

Here is another example of JSON payload, with this time only one child element to be encrypted ("_Field Level Encryption_"):

```json
{
    "action": "ORDER",
    "actionId": "91c693c6-4022-4341-ac6a-27c82f599fd8",
    "paymentCard": {
        "pan": "5500-0000-0000-0004",
        "expiry": "12/22"
    }
}
```

And here is an encrypted version of it:

```json
{
    "action": "ORDER",
    "actionId": "91c693c6-4022-4341-ac6a-27c82f599fd8",
    "encryptedPaymentCard": {
        "iv": "7f1105fb0c684864a189fb3709ce3d28",
        "encryptedKey": "67f467d1b653d98411a0c6d3c(...)ffd4c09dd42f713a51bff2b48f937c8",
        "encryptedValue": "b73aabd267517fc09ed72455c2(...)dffb5fa04bf6e6ce9ade1ff514ed6141",
        "publicKeyFingerprint": "80810fc13a8319fcf0e2e(...)82cc3ce671176343cfe8160c2279",
        "oaepPaddingDigestAlgorithm": "SHA512"
    }
}
```

# Getting Keys for Your Application

As seen above, payload encryption involves two RSA key pairs. Encryption keys for your projects are set up through your [Developer Dashboard](https://developer.mastercard.com/dashboard) and you can manage the keys’ lifecycle from there.

## Key Pairs

The public key your application uses to encrypt requests is listed under _Client Encryption Keys_:

![client-encryption-key-example](https://static.developer.mastercard.com/content/platform/img/20240110-client-encryption-keys.png)

The public key Mastercard uses to encrypt responses is listed under _Mastercard Encryption Keys_:

![mastercard-encryption-key-example](https://static.developer.mastercard.com/content/platform/img/20240110-mastercard-encryption-keys.png)

## Keys and Environments

There are two different types of keys, depending on the stage of your project:

1.  Sandbox keys, to be used with an API sandbox that mimics a live production environment (_sandbox.api.mastercard.com_)
2.  Production keys, which allow an application to encrypt/decrypt content in the production environment (_api.mastercard.com_)

A pre-production environment called MTF (for “_Mastercard Test Facility_”) can possibly be made available. In the following picture, MTF is using sandbox keys:

![encryption-key-usage-by-environment](https://static.developer.mastercard.com/content/platform/img/environment-encryption-keys.png)

## Creating Keys

To add encryption keys to an existing project, click “_Add Key_” next to the service name you would like to add keys to and select the key type you want to add:

![select-key-type](https://static.developer.mastercard.com/content/platform/img/20240201-add-encryption-keys.png)

Two methods are available when creating a _Mastercard Encryption Key_:

### Method 1

*   A key pair and a [certificate signing request (CSR)](https://en.wikipedia.org/wiki/Certificate_signing_request) are generated inside your web browser
*   Mastercard signs and sends your browser back an [X509 certificate](https://en.wikipedia.org/wiki/X.509) matching your private key
*   Your browser generates a [PKCS#12](https://en.wikipedia.org/wiki/PKCS_12) key store file securing your private key with the provided passphrase

![create-key-browser](https://static.developer.mastercard.com/content/platform/img/20240110-create-key-in-browser.png)

### Method 2

*   You manually upload a [certificate signing request (CSR)](https://en.wikipedia.org/wiki/Certificate_signing_request) generated in your own system
*   Mastercard issues an [X509 certificate](https://en.wikipedia.org/wiki/X.509) matching your private key (you can request this certificate to be sent to you through the “Support” section)

![create-key-from-csr](https://static.developer.mastercard.com/content/platform/img/20240110-create-key-from-csr.png)

> [!WARNING]
> 
> Mastercard doesn’t know and never stores your private keys. It means _only you_ can decrypt responses sent to your application, but it also means there is no way to recover a key you lost!

# Client Libraries

Mastercard provides [client encryption libraries](https://github.com/Mastercard?q=client-encryption) in several languages you can integrate to your project or use as reference implementations:

|     | language-java Created with Sketch. | language\_csharp Created with Sketch. | language-python Created with Sketch. | language-nodejs Created with Sketch. |     |     |     |
| :---: | :---: | :---: | :---: | :---: | :---: | --- | --- |
| **Download/install** | [<br><br>![java-version](https://img.shields.io/maven-central/v/com.mastercard.developer/client-encryption.svg?style=flat&color=f99f1c&label=)<br><br>](https://search.maven.org/artifact/com.mastercard.developer/client-encryption/) | [<br><br>![c-sharp-version](https://img.shields.io/nuget/v/Mastercard.Developer.ClientEncryption.Core.svg?style=flat&color=f99f1c&label=)<br><br>](https://www.nuget.org/packages/Mastercard.Developer.ClientEncryption.RestSharpV2/) | [<br><br>![python-version](https://img.shields.io/pypi/v/mastercard-client-encryption.svg?style=flat&color=f99f1c&label=)<br><br>](https://pypi.org/project/mastercard-client-encryption/) | [<br><br>![node-js-version](https://img.shields.io/npm/v/mastercard-client-encryption.svg?style=flat&color=f99f1c&label=)<br><br>](https://www.npmjs.com/package/mastercard-client-encryption) | [<br><br>![go-version](https://img.shields.io/github/v/release/mastercard/client-encryption-go.svg?style=flat&color=f99f1c&label=)<br><br>](https://github.com/Mastercard/client-encryption-go) |     |     |
| **View on GitHub** | [<br><br>![java-github-badge](https://img.shields.io/github/stars/mastercard/client-encryption-java.svg?label=&style=social)<br><br>](https://github.com/Mastercard/client-encryption-java) | [<br><br>![c-sharp-github-badge](https://img.shields.io/github/stars/mastercard/client-encryption-csharp.svg?label=&style=social)<br><br>](https://github.com/Mastercard/client-encryption-csharp) | [<br><br>![python-github-badge](https://img.shields.io/github/stars/mastercard/client-encryption-python.svg?label=&style=social)<br><br>](https://github.com/Mastercard/client-encryption-python) | [<br><br>![node-js-github-badge](https://img.shields.io/github/stars/mastercard/client-encryption-nodejs.svg?label=&style=social)<br><br>](https://github.com/Mastercard/client-encryption-nodejs) | [<br><br>![go-github-badge](https://img.shields.io/github/stars/mastercard/client-encryption-go.svg?label=&style=social)<br><br>](https://github.com/Mastercard/client-encryption-go) |     |     |

To get started, simply add to your project the package matching your application development language. You can also refer to the different [README.md](https://github.com/Mastercard/client-encryption-csharp/blob/master/README.md) files for detailed how-to information.

> [!TIP]
> 
> We strongly encourage you to use existing libraries rather than implementing the encryption and decryption steps yourself.

# Insomnia Plugin

While integrating with Mastercard APIs, you can also try our plugin for [Insomnia](https://insomnia.rest/). Click the links below to browse the project.

|     |     |     |     |     |     |     |     |
| :---: | :---: | :---: | :---: | :---: | :---: | :---: | --- |
| **Download/install** | [<br><br>![insomnia-version](https://img.shields.io/npm/v/insomnia-plugin-mastercard.svg?style=flat&color=f99f1c&label=)<br><br>](https://www.npmjs.com/package/insomnia-plugin-mastercard) | ![blank-image](https://static.developer.mastercard.com/content/platform/img/blank.png) | ![blank-image](https://static.developer.mastercard.com/content/platform/img/blank.png) | ![blank-image](https://static.developer.mastercard.com/content/platform/img/blank.png) | ![blank-image](https://static.developer.mastercard.com/content/platform/img/blank.png) | ![blank-image](https://static.developer.mastercard.com/content/platform/img/blank.png) |     |
| **View on GitHub** | [<br><br>![insomnia-github-badge](https://img.shields.io/github/stars/mastercard/insomnia-plugin-mastercard.svg?label=&style=social)<br><br>](https://github.com/Mastercard/insomnia-plugin-mastercard) |     |     |     |     |     |     |

# Development Tips

## Extracting the Encryption Key

The public request encryption key is provided through a PEM certificate file (`BEGIN CERTIFICATE`). To export it to a PKCS#8 PEM key file (`BEGIN PUBLIC KEY`), run:

```bash
openssl x509 -pubkey -noout -in cert.pem  > key.pem
```

## Exporting Your Decryption Key

Your private response decryption key is encrypted in a PKCS#12 password-protected file you can directly use with Mastercard client libraries. To export RSA keys to alternative formats, you can run the same commands as for [Exporting Your Signing Key](https://developer.mastercard.com/platform/documentation/authentication/using-oauth-1a-to-access-mastercard-apis/#exporting-your-signing-key).

> [!WARNING]
> 
> Always keep your private signing keys safe, in a password-protected or hardware key store!

# Frequently Asked Questions

No questions yet.

# Further Reading

*   [Protecting the payments ecosystem](https://www.mastercard.com/sdp)
*   [PCI DSS v3.2.1](https://www.pcisecuritystandards.org/documents/PCI_DSS_v3-2-1.pdf)name: Build & Test
'on':
  push:
    branches:
      - "**"
  pull_request:
    branches:
      - "**"
  schedule:
    - cron: 0 16 * * *
  workflow_dispatch:

jobs:

  build:
    runs-on: ubuntu-latest
    strategy:
      matrix:
        go: ['1.23']

    steps:
    - uses: actions/checkout@v2

    - name: Set up Go
      uses: actions/setup-go@v2
      with:
        go-version: ${{ matrix.go }}

    - name: Build
      run: go build -v ./...

    - name: Test
      run: go test -v ./...
